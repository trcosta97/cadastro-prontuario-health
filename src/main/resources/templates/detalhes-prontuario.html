<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Detalhes do Prontuário</title>
    <style>
        body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          background-color: #f7f9fc;
          margin: 0;
          padding: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        h1 {
          margin: 2rem 0 1rem;
          color: #2c3e50;
        }

        #detalhes-prontuario {
          background-color: #ffffff;
          padding: 2rem;
          border-radius: 12px;
          box-shadow: 0 4px 10px rgba(0,0,0,0.05);
          max-width: 600px;
          width: 90%;
          margin-bottom: 2rem;
          color: #34495e;
        }

        #detalhes-prontuario p {
          margin: 0.5rem 0;
          line-height: 1.5;
        }

        strong {
          color: #2d3436;
        }

        @media (max-width: 600px) {
          #detalhes-prontuario {
            padding: 1.5rem;
          }

          h1 {
            font-size: 1.5rem;
          }
        }
    </style>
</head>
<body>
<h1>Detalhes do Prontuário</h1>
<div id="detalhes-prontuario">Carregando...</div>

<script>
    const token = localStorage.getItem("jwtToken");
    const path = window.location.pathname;
    const id = path.substring(path.lastIndexOf('/') + 1);

    fetch(`/api/prontuarios/${id}`, {
      headers: {
        "Authorization": `Bearer ${token}`,
        "Content-Type": "application/json"
      }
    })
    .then(res => {
      if (!res.ok) throw new Error(`Erro ${res.status}`);
      return res.json();
    })
    .then(prontuario => {
      if (!prontuario) {
        document.getElementById("detalhes-prontuario").innerText = "Prontuário não encontrado.";
        return;
      }

      const div = document.getElementById("detalhes-prontuario");
      const nomeMedico = prontuario.medico?.nomeCompleto || "(sem médico)";
      const nomePaciente = prontuario.paciente?.nomeCompleto || "(sem paciente)";

      div.innerHTML = `
        <p><strong>ID:</strong> ${prontuario.id}</p>
        <p><strong>Paciente:</strong> ${nomePaciente}</p>
        <p><strong>Médico:</strong> ${nomeMedico}</p>
        <p><strong>Data de Atendimento:</strong> ${prontuario.dataAtendimento}</p>
        <p><strong>Subjetivo:</strong> ${prontuario.subjetivo}</p>
        <p><strong>Objetivo:</strong> ${prontuario.objetivo}</p>
        <p><strong>Avaliação:</strong> ${prontuario.avaliacao}</p>
        <p><strong>Plano:</strong> ${prontuario.plano}</p>
        <p><strong>HAS:</strong> ${prontuario.hipertensaoArterialSistemica ? "Sim" : "Não"}</p>
        <p><strong>Diabetes:</strong> ${prontuario.diabetes ? "Sim" : "Não"}</p>
        <p><strong>Tuberculose:</strong> ${prontuario.tuberculose ? "Sim" : "Não"}</p>
        <p><strong>Hanseníase:</strong> ${prontuario.hanseniase ? "Sim" : "Não"}</p>
        <p><strong>Ativo:</strong> ${prontuario.ativo ? "Sim" : "Não"}</p>
      `;
    })
    .catch(err => {
      document.getElementById("detalhes-prontuario").innerText = "Erro ao carregar prontuário.";
      console.error("Erro:", err);
    });
</script>
</body>
</html>
